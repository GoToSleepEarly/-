

# 单调栈

单调栈题型关键字：**顺序元素比大小**，如**下一个更大**，**顺序字典序**

单调栈的本质是贪心算法，其性质(以单调增为例)如下：

**单调栈里的元素**：

- 入栈过程中，能找到右侧第一个比他小的数
- 能找到左侧第一个比他小的数

**将要加入单调栈的元素**：

- 当入栈结束后，能找到第一个比他小的数

------

## 单调栈模板

### 解题步骤：

1. 判断使用单调增还是单调减
2. 判断入栈和出栈的条件
3. 判断如何计算出结果

```java
public int solve(int[] T) {
    Deque<Integer> stack = new LinkedList<>();
        int[] res = new int[T.length];
        for (int i = 0; i < T.length; i++) {
            int temp = T[i];
            while (!stack.isEmpty() && temp > T[stack.peek()]) {
                int index = stack.poll();
                res[index] = i - index;
            }
            stack.addFirst(i);
        }
        while (!stack.isEmpty()) {
            res[stack.poll()] = 0;
        }
        return res;
}
```
### Tips：

1. 单调栈入栈**是有条件的**，可能不只是简单的比大小，还可能与元素是否使用过，出栈次数上限等有关。
2. 多维的题目优先考虑**降维（按行，按列）**，之后再用单调栈。一般而言都是从暴力解法的出单调栈解法。

------

## 单调栈练习题

按照难度依次排列如下：

**1、No739每日温度：**

基本套路题，按照流程解答即可

**2、No503下一个更大元素2：**

把遍历一次，改成了遍历两次。

如果合并到一次循环，需要考虑**入栈和出栈的条件**。

**3、No901股票价格跨度：**

入栈元素稳定后，能找到第一个比他大（小）元素性质的运用

**4、直方图的水量：**

难题，按行或者按列降维。行是单调栈，列是枚举最大最小值。

**5、No84柱状图中最大的矩形：**

接雨水的进阶题，依旧是降维，难度更上一层。

**6、No1673找出最具竞争力的子序列：**

带条件的单调栈，需要掌握

**7、No402移掉K位数字：**

同上。

**8、No1081不同字符的最小子序列：**

带条件的单调栈之进阶题，需要思路，实现有难度

**9、No456之132模式：**

逆序使用单调栈，很难思考到。

考虑到k的取值是j右边最接近j值的数，单调栈不符合这个性质，这个时候逆向思考求解。通过k去枚举j。